# üöÄ Heroku Deployment Guide - Parking Ticket App

This guide will help you deploy your parking ticket app to Heroku with **full Selenium support** including the "Fight Ticket" browser automation feature.

## ‚úÖ What Works on Heroku

- ‚úÖ **PDF Generation** - Create parking receipts
- ‚úÖ **OCR Image Processing** - Scan ticket images with Google Cloud Vision
- ‚úÖ **Profile Management** - Save user information
- ‚úÖ **Email Sending** - Send receipts via email
- ‚úÖ **Selenium Browser Automation** - Fight Ticket button that fills Montreal forms
- ‚úÖ **All Flask Routes** - Complete web application

## üìã Prerequisites

1. **Heroku CLI** - Download from: https://devcenter.heroku.com/articles/heroku-cli
2. **Git** - Make sure git is installed
3. **API Keys** (optional but recommended):
   - Resend API key for email functionality
   - Google Cloud Vision API credentials for OCR

## üîß Step-by-Step Deployment

### Step 1: Install Heroku CLI

1. Download Heroku CLI from: https://devcenter.heroku.com/articles/heroku-cli
2. Install and restart your terminal
3. Verify installation: `heroku --version`

### Step 2: Set up Heroku App

Run the setup script:
```powershell
.\heroku-setup.ps1
```

This will:
- Login to Heroku
- Create your app
- Add Python buildpack
- Add Chrome buildpack for Selenium
- Initialize git repository
- Add Heroku remote

### Step 3: Configure Environment Variables

Run the environment setup script:
```powershell
.\set-env-vars.ps1
```

This will set up:
- `SECRET_KEY` - Flask session security
- `RESEND_API_KEY` - Email functionality (optional)
- `GOOGLE_APPLICATION_CREDENTIALS_JSON` - OCR functionality (optional)

### Step 4: Deploy to Heroku

```powershell
# Add all files to git
git add .

# Commit changes
git commit -m "Deploy parking ticket app to Heroku"

# Deploy to Heroku
git push heroku main
```

### Step 5: Open Your App

```powershell
heroku open --app your-app-name
```

## üîë Important Environment Variables

### Required:
- `SECRET_KEY` - Auto-generated by the setup script

### Optional (but recommended):
- `RESEND_API_KEY` - Get from https://resend.com for email features
- `GOOGLE_APPLICATION_CREDENTIALS_JSON` - Google Cloud service account JSON for OCR

### Example Google Cloud JSON format:
```json
{"type":"service_account","project_id":"your-project","private_key_id":"...","private_key":"-----BEGIN PRIVATE KEY-----\\n...\\n-----END PRIVATE KEY-----\\n","client_email":"...","client_id":"...","auth_uri":"...","token_uri":"..."}
```

## ü§ñ Selenium Features on Heroku

Your "Fight Ticket" button will work on Heroku with these differences:
- **Headless Mode**: Chrome runs in headless mode (no visible browser)
- **Server-Side**: Automation happens on Heroku's servers
- **Form Filling**: Still fills out Montreal dispute forms automatically

## üêõ Troubleshooting

### If deployment fails:
```powershell
heroku logs --tail --app your-app-name
```

### If Selenium fails:
1. Check that Chrome buildpack is installed:
   ```powershell
   heroku buildpacks --app your-app-name
   ```

2. Verify environment variables:
   ```powershell
   heroku config --app your-app-name
   ```

### If email doesn't work:
- Make sure `RESEND_API_KEY` is set
- Verify your Resend account is active

### If OCR doesn't work:
- Check `GOOGLE_APPLICATION_CREDENTIALS_JSON` is set correctly
- Verify Google Cloud Vision API is enabled

## üîÑ Updating Your App

To deploy changes:
```powershell
git add .
git commit -m "Update app"
git push heroku main
```

## üí∞ Heroku Pricing

- **Free Tier**: 550-1000 dyno hours/month
- **Selenium**: Works on free tier (limited hours)
- **Database**: Can add PostgreSQL if needed

## üéâ Success!

Your parking ticket app is now hosted on Heroku with:
- ‚úÖ Full functionality including Selenium automation
- ‚úÖ Chrome browser automation for "Fight Ticket" feature
- ‚úÖ PDF generation, OCR, email, and profile management
- ‚úÖ Production-ready deployment

Access your app at: `https://your-app-name.herokuapp.com`
